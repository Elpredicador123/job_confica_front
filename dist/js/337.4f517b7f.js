"use strict";(self["webpackChunkminible"]=self["webpackChunkminible"]||[]).push([[337],{313:function(e,t,l){l.r(t),l.d(t,{default:function(){return Y}});var i=l(6252),n=l(9963),s=l(3577);const o={class:"app-calendar"},a={class:"mb-3"},d=(0,i._)("label",{for:"name",class:"form-label"},"Event Name",-1),r={key:0,class:"invalid-feedback"},c={class:"mb-3"},u=(0,i._)("label",{class:"control-label form-label"},"Category",-1),m=["value"],v={key:0,class:"invalid-feedback"},p={class:"mb-3"},h=(0,i._)("label",{for:"description",class:"form-label"},"Descripción",-1),f={class:"mb-3"},b=(0,i._)("label",{for:"numberOfPeople",class:"form-label"},"Número de Personas",-1),_={class:"text-end pt-5 mt-3"},w={class:"mb-3"},g=(0,i._)("label",{for:"name",class:"form-label"},"Event Name",-1),y={class:"mb-3"},D=(0,i._)("label",{class:"control-label form-label"},"Category",-1),C=["value"],k={class:"mb-3"},E=(0,i._)("label",{for:"description",class:"form-label"},"Descripción",-1),M={class:"mb-3"},W=(0,i._)("label",{for:"numberOfPeople",class:"form-label"},"Número de Personas",-1),$={class:"d-flex justify-content-between"},S={class:"d-flex"};function T(e,t,l,T,U,x){const B=(0,i.up)("PageHeader"),V=(0,i.up)("FullCalendar"),N=(0,i.up)("BCardBody"),P=(0,i.up)("BCard"),O=(0,i.up)("BCol"),Z=(0,i.up)("BRow"),q=(0,i.up)("BButton"),R=(0,i.up)("BForm"),H=(0,i.up)("BModal"),G=(0,i.up)("b-button"),I=(0,i.up)("Layout");return(0,i.wg)(),(0,i.j4)(I,null,{default:(0,i.w5)((()=>[(0,i.Wm)(B,{title:U.title,items:U.items},null,8,["title","items"]),(0,i.Wm)(Z,null,{default:(0,i.w5)((()=>[(0,i.Wm)(O,{cols:"12"},{default:(0,i.w5)((()=>[(0,i.Wm)(P,{"np-body":""},{default:(0,i.w5)((()=>[(0,i.Wm)(N,null,{default:(0,i.w5)((()=>[(0,i._)("div",o,[(0,i.Wm)(V,{ref:"fullCalendar",options:U.calendarOptions},null,8,["options"])])])),_:1})])),_:1})])),_:1})])),_:1}),(0,i.Wm)(H,{modelValue:U.showModal,"onUpdate:modelValue":t[4]||(t[4]=e=>U.showModal=e),title:"Add New Event","title-class":"font-18","body-class":"p-3","hide-footer":""},{default:(0,i.w5)((()=>[(0,i.Wm)(R,{onSubmit:(0,n.iM)(x.handleSubmit,["prevent"])},{default:(0,i.w5)((()=>[(0,i.Wm)(Z,null,{default:(0,i.w5)((()=>[(0,i.Wm)(O,{cols:"12"},{default:(0,i.w5)((()=>[(0,i._)("div",a,[d,(0,i.wy)((0,i._)("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>U.event.title=e),type:"text",class:(0,s.C_)(["form-control",{"is-invalid":U.submitted&&T.v$.event.title.$error}]),placeholder:"Insert Event name"},null,2),[[n.nr,U.event.title]]),U.submitted&&T.v$.event.title.required.$invalid?((0,i.wg)(),(0,i.iD)("div",r," This value is required. ")):(0,i.kq)("",!0)])])),_:1}),(0,i.Wm)(O,{cols:"12"},{default:(0,i.w5)((()=>[(0,i._)("div",c,[u,(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>U.event.category=e),class:(0,s.C_)(["form-control",{"is-invalid":U.submitted&&T.v$.event.category.errors}]),name:"category"},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(U.categories,(e=>((0,i.wg)(),(0,i.iD)("option",{key:e.backgroundColor,value:`${e.value}`},(0,s.zw)(e.name),9,m)))),128))],2),[[n.bM,U.event.category]]),U.submitted&&T.v$.event.category.$invalid?((0,i.wg)(),(0,i.iD)("div",v," This value is required. ")):(0,i.kq)("",!0)])])),_:1}),(0,i.Wm)(O,{cols:"12"},{default:(0,i.w5)((()=>[(0,i._)("div",p,[h,(0,i.wy)((0,i._)("textarea",{id:"description","onUpdate:modelValue":t[2]||(t[2]=e=>U.event.description=e),class:"form-control",placeholder:"Descripción del evento"},null,512),[[n.nr,U.event.description]])])])),_:1}),(0,i.Wm)(O,{cols:"12"},{default:(0,i.w5)((()=>[(0,i._)("div",f,[b,(0,i.wy)((0,i._)("input",{id:"numberOfPeople","onUpdate:modelValue":t[3]||(t[3]=e=>U.event.numberOfPeople=e),type:"number",class:"form-control",placeholder:"Número de personas"},null,512),[[n.nr,U.event.numberOfPeople]])])])),_:1})])),_:1}),(0,i._)("div",_,[(0,i.Wm)(q,{variant:"light",onClick:x.hideModal},{default:(0,i.w5)((()=>[(0,i.Uk)("Close")])),_:1},8,["onClick"]),(0,i.Wm)(q,{type:"submit",variant:"success",class:"ms-1"},{default:(0,i.w5)((()=>[(0,i.Uk)("Create event")])),_:1})])])),_:1},8,["onSubmit"])])),_:1},8,["modelValue"]),(0,i.Wm)(H,{modelValue:U.eventModal,"onUpdate:modelValue":t[10]||(t[10]=e=>U.eventModal=e),title:"Edit Event","title-class":"font-18","hide-footer":"","body-class":"p-3"},{default:(0,i.w5)((()=>[(0,i._)("form",{onSubmit:t[9]||(t[9]=(0,n.iM)(((...e)=>x.editSubmit&&x.editSubmit(...e)),["prevent"]))},[(0,i.Wm)(Z,null,{default:(0,i.w5)((()=>[(0,i.Wm)(O,{cols:"12"},{default:(0,i.w5)((()=>[(0,i._)("div",w,[g,(0,i.wy)((0,i._)("input",{id:"name","onUpdate:modelValue":t[5]||(t[5]=e=>U.editevent.editTitle=e),type:"text",class:"form-control",placeholder:"Insert Event name"},null,512),[[n.nr,U.editevent.editTitle]])])])),_:1}),(0,i.Wm)(O,{cols:"12"},{default:(0,i.w5)((()=>[(0,i._)("div",y,[D,(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>U.editevent.editcategory=e),class:"form-control",name:"category"},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(U.categories,(e=>((0,i.wg)(),(0,i.iD)("option",{key:e.backgroundColor,value:`${e.value}`},(0,s.zw)(e.name),9,C)))),128))],512),[[n.bM,U.editevent.editcategory]])])])),_:1}),(0,i.Wm)(O,{cols:"12"},{default:(0,i.w5)((()=>[(0,i._)("div",k,[E,(0,i.wy)((0,i._)("textarea",{id:"description","onUpdate:modelValue":t[7]||(t[7]=e=>U.editevent.editDescription=e),class:"form-control",placeholder:"Descripción del evento"},null,512),[[n.nr,U.editevent.editDescription]])])])),_:1}),(0,i.Wm)(O,{cols:"12"},{default:(0,i.w5)((()=>[(0,i._)("div",M,[W,(0,i.wy)((0,i._)("input",{id:"numberOfPeople","onUpdate:modelValue":t[8]||(t[8]=e=>U.editevent.editNumber_of_people=e),type:"number",class:"form-control",placeholder:"Número de personas"},null,512),[[n.nr,U.editevent.editNumber_of_people]])])])),_:1})])),_:1}),(0,i._)("div",$,[(0,i.Wm)(q,{class:"ms-1",variant:"danger",onClick:x.confirm},{default:(0,i.w5)((()=>[(0,i.Uk)("Delete")])),_:1},8,["onClick"]),(0,i._)("div",S,[(0,i.Wm)(q,{variant:"light",onClick:x.closeModal},{default:(0,i.w5)((()=>[(0,i.Uk)("Close")])),_:1},8,["onClick"]),(0,i.Wm)(G,{class:"ms-1",variant:"success",onClick:x.editSubmit},{default:(0,i.w5)((()=>[(0,i.Uk)("Save")])),_:1},8,["onClick"])])])],32)])),_:1},8,["modelValue"])])),_:1})}var U=l(4813),x=l(6993),B=l(1029),V=l(9897),N=l(325),P=l(7292),O=l(5705),Z=l(760),q=l(6455),R=l.n(q),H=l(4642),G=l(1022),I=l(6286),L=l(2298),A={components:{FullCalendar:U.Z,Layout:H.Z,PageHeader:G.Z},setup(){return{v$:(0,O.Xw)()}},data(){return{title:"Reservation",items:[{text:"Minible"},{text:"Reservaciones",active:!0}],calendarEvents:[],calendarOptions:{eventDrop:this.handleEventDrop,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},plugins:[x.Z,B.Z,V.ZP,N.Z,P.Z],initialView:"dayGridMonth",themeSystem:"bootstrap",initialEvents:[],editable:!0,droppable:!0,eventResizableFromStart:!0,dateClick:this.dateClicked,eventClick:this.editEvent,eventsSet:this.handleEvents,weekends:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,select:this.handleSelect},currentEvents:[],tableData:[],showModal:!1,eventModal:!1,categories:I.b,submitted:!1,submit:!1,newEventData:{},edit:{},deleteId:{},event:{title:"",category:"",number_of_people:null,description:"",time:null},editevent:{editTitle:"",editCategory:"",editNumber_of_people:null,editDescription:""}}},validations:{event:{title:{required:Z.C1},category:{required:Z.C1}}},mounted(){this.getData()},methods:{handleSelect(e){this.newEventData=e,this.showModal=!0},async getData(){try{const e=await this.$http.get(this.$apiURL+"reservation/all");this.calendarOptions.events=e.data.data,this.event.category="Danger",console.log(this.calendarOptions.events)}catch(e){console.error(e)}},handleEventDrop(e){console.log(e.event.description);const t=(0,L.Z)(new Date(e.event.start),"yyyy-MM-dd'T'HH:mm:ssXXX"),[l,i]=t.split("T"),[n,s]=i.split("-"),o={date:l,start_time:n,end_time:s,id:parseInt(e.event.id)};this.updateEvent(e.event.id,o)},updateEvent(e,t){console.log(e,t),this.$http.post(this.$apiURL+"reservation/store",t).then((e=>{console.log(e),this.successmsg(),this.showModal=!1,this.getData()})).catch((e=>{console.error(e)}))},handleSubmit(){if(this.submitted=!0,this.v$.$touch(),this.v$.$invalid)return;let e="",t="",l="",i="",n="",s=null;if(console.log(this.newEventData),this.newEventData.endStr){let o="";s=this.newEventData.endStr,[e,t]=s.split("T"),[i,o]=t.split("-"),s=this.newEventData.startStr,[e,t]=s.split("T"),[l,n]=t.split("-"),console.log(n,o)}else{s=this.newEventData.dateStr,[e,t]=s.split("T"),[l,n]=t.split("-"),s=this.newEventData.dateStr,[e,t]=s.split("T"),[l,n]=t.split("-");let o=new Date(`2000-01-01T${l}`),a=new Date(o.getTime()+18e5);i=a.toTimeString().slice(0,5)}const o={title:this.event.title,description:this.event.description,number_of_people:this.event.numberOfPeople,date:e,start_time:l,end_time:i,user_id:1};console.log(o),this.$http.post(this.$apiURL+"reservation/store",o).then((e=>{console.log(e),this.successmsg(),this.showModal=!1,this.getData()})).catch((e=>{console.error(e)})),this.submitted=!1,this.event={}},hideModal(){this.submitted=!1,this.showModal=!1,this.event={}},editSubmit(){console.log(this.editevent);const e={title:this.editevent.editTitle,description:this.editevent.editDescription,number_of_people:this.editevent.editNumber_of_people,id:parseInt(this.edit.id)};this.updateEvent(this.edit.id,e),this.closeModal()},deleteEvent(){this.edit.remove(),this.eventModal=!1},dateClicked(e){"dayGridMonth"!==this.$refs.fullCalendar.getApi().view.type?(this.newEventData=e,this.showModal=!0):R().fire({title:"Acción no permitida",text:"No se pueden crear eventos en la vista de mes.",icon:"error",confirmButtonColor:"#34c38f"})},editEvent(e){console.log(e),this.edit=e.event,this.editevent.editTitle=this.edit.title,this.editevent.editDescription=this.edit.extendedProps.description,this.editevent.editNumber_of_people=this.edit.extendedProps.number_of_people,this.editevent.editcategory=this.edit.classNames[0],this.eventModal=!0},closeModal(){this.eventModal=!1},confirm(){R().fire({title:"Are you sure?",text:"You won't be able to delete this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then((e=>{e.value&&(this.deleteEvent(),R().fire("Deleted!","Event has been deleted.","success"))}))},handleEvents(e){this.currentEvents=e},successmsg(){R().fire({position:"center",icon:"success",title:"Event has been saved",showConfirmButton:!1,timer:1e3})}}},F=l(3744);const X=(0,F.Z)(A,[["render",T]]);var Y=X}}]);
//# sourceMappingURL=337.4f517b7f.js.map