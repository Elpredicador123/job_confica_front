"use strict";(self["webpackChunkminible"]=self["webpackChunkminible"]||[]).push([[480],{8104:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var s=a(6252),r=a(3577);const i=(0,s._)("i",{class:"bx bx-check-circle"},null,-1),l={class:"table-responsive mb-0"},n=(0,s._)("i",{class:"bx bx-check-circle"},null,-1),o={class:"table-responsive mb-0"},d={class:"row"},c=(0,s._)("i",{class:"bx bx-check-circle"},null,-1),m={class:"table-responsive mb-0"},u=(0,s._)("i",{class:"bx bx-check-circle"},null,-1),f={class:"table-responsive mb-0"};function h(e,t,a,h,p,g){const b=(0,s.up)("PageHeader"),O=(0,s.up)("BCol"),_=(0,s.up)("BRow"),w=(0,s.up)("BCardHeader"),G=(0,s.up)("BFormSelect"),y=(0,s.up)("BTable"),I=(0,s.up)("BCardBody"),W=(0,s.up)("BCard"),D=(0,s.up)("BButton"),k=(0,s.up)("Layout");return(0,s.wg)(),(0,s.j4)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,{title:p.title,items:p.items},null,8,["title","items"]),(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(O,{lg:"6"},{default:(0,s.w5)((()=>[(0,s.Wm)(W,{"no-body":""},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{style:{padding:"1em","background-color":"#5b73e8",color:"#ffff !important"}},{default:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(O,{sm:"7"},{default:(0,s.w5)((()=>[i,(0,s.Uk)("   Avance instalaciones ")])),_:1}),(0,s.Wm)(O,{sm:"5"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Actualizado a las "+(0,r.zw)(p.dataDateInstalaciones),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(I,null,{default:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(O,{cols:"7"}),(0,s.Wm)(O,{cols:"5"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Filtrar por: "),(0,s.Wm)(G,{modelValue:p.ciudadId,"onUpdate:modelValue":t[0]||(t[0]=e=>p.ciudadId=e),size:"sm",options:p.Ciudades,onChange:t[1]||(t[1]=e=>g.getTableInstalaciones())},null,8,["modelValue","options"])])),_:1})])),_:1}),(0,s._)("div",l,[(0,s.Wm)(y,{items:p.TableInstalaciones,fields:p.fields,responsive:"sm","per-page":p.perPage,"current-page":p.currentPage,"sort-by":p.sortBy,"sort-desc":p.sortDesc,filter:p.filter,"filter-included-fields":p.filterOn,onFiltered:e.onFiltered},null,8,["items","fields","per-page","current-page","sort-by","sort-desc","filter","filter-included-fields","onFiltered"])])])),_:1})])),_:1})])),_:1}),(0,s.Wm)(O,{lg:"6"},{default:(0,s.w5)((()=>[(0,s.Wm)(W,{"no-body":""},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{style:{padding:"1em","background-color":"#5b73e8",color:"#ffff !important"}},{default:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(O,{sm:"7"},{default:(0,s.w5)((()=>[n,(0,s.Uk)("   Ordenes por gestor instalaciones ")])),_:1}),(0,s.Wm)(O,{sm:"5"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Actualizado a las "+(0,r.zw)(p.dataDateGestor),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(I,null,{default:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(O,{cols:"7"}),(0,s.Wm)(O,{cols:"5"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Filtrar por: "),(0,s.Wm)(G,{modelValue:p.GestorAgendaId,"onUpdate:modelValue":t[2]||(t[2]=e=>p.GestorAgendaId=e),size:"sm",options:p.GestorAgenda,onChange:t[3]||(t[3]=e=>g.getTableGestor())},null,8,["modelValue","options"])])),_:1})])),_:1}),(0,s._)("div",o,[(0,s.Wm)(y,{items:p.tableDataGestor,fields:p.fieldsGestor,responsive:"sm","per-page":p.perPageGestor,"current-page":p.currentPageGestor,"sort-by":p.sortByGestor,"sort-desc":p.sortDescGestor,filter:p.filterGestor,"filter-included-fields":p.filterOnGestor,onFiltered:e.onFilteredGestor},null,8,["items","fields","per-page","current-page","sort-by","sort-desc","filter","filter-included-fields","onFiltered"])])])),_:1})])),_:1})])),_:1})])),_:1}),(0,s._)("div",d,[(0,s.Wm)(O,{lg:"6"},{default:(0,s.w5)((()=>[(0,s.Wm)(W,{"no-body":""},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{style:{padding:"1em","background-color":"#5b73e8",color:"#ffff !important"}},{default:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(O,{sm:"7"},{default:(0,s.w5)((()=>[c,(0,s.Uk)("   Avance Mantenimientos ")])),_:1}),(0,s.Wm)(O,{sm:"5"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Actualizado a las "+(0,r.zw)(p.dataDateMantenimientos),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(I,null,{default:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(O,{cols:"7"}),(0,s.Wm)(O,{cols:"5"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Filtrar por: "),(0,s.Wm)(G,{modelValue:p.ciudadId2,"onUpdate:modelValue":t[4]||(t[4]=e=>p.ciudadId2=e),size:"sm",options:p.Ciudades,onChange:t[5]||(t[5]=e=>g.getTableMantenimientos())},null,8,["modelValue","options"])])),_:1})])),_:1}),(0,s._)("div",m,[(0,s.Wm)(y,{items:p.tableMantenimiento,fields:p.fieldsMantenimiento,responsive:"sm","per-page":p.perPage2,"current-page":p.currentPage2,"sort-by":p.sortBy2,"sort-desc":p.sortDesc2,filter:p.filter2,"filter-included-fields":p.filterOn2,onFiltered:e.onFiltered},null,8,["items","fields","per-page","current-page","sort-by","sort-desc","filter","filter-included-fields","onFiltered"])])])),_:1})])),_:1})])),_:1}),(0,s.Wm)(O,{lg:"6"},{default:(0,s.w5)((()=>[(0,s.Wm)(W,{"no-body":""},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{style:{padding:"1em","background-color":"#5b73e8",color:"#ffff !important"}},{default:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(O,{sm:"7"},{default:(0,s.w5)((()=>[u,(0,s.Uk)("   Ordenes por gestor - horas pendientes ")])),_:1}),(0,s.Wm)(O,{sm:"5"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Actualizado a las "+(0,r.zw)(p.dataDateOrder),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(I,null,{default:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(O,{cols:"8"}),(0,s.Wm)(O,{cols:"4"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Filtrar por: "),(0,s.Wm)(G,{modelValue:p.OrdenesGestorId,"onUpdate:modelValue":t[6]||(t[6]=e=>p.OrdenesGestorId=e),size:"sm",options:p.OrdenesGestor,onChange:t[7]||(t[7]=e=>g.getTableOrder())},null,8,["modelValue","options"])])),_:1})])),_:1}),(0,s._)("div",f,[(0,s.Wm)(y,{items:p.tableDataOrder,fields:p.fieldsOrder,responsive:"sm","per-page":p.perPageOrder,"current-page":p.currentPageOrder,"sort-by":p.sortByOrder,"sort-desc":p.sortDescOrder,filter:p.filterOrder,"filter-included-fields":p.filterOnOrder,onFiltered:e.onFilteredOrder},{"cell(button)":(0,s.w5)((e=>[(0,s.Wm)(D,{variant:g.getColor(e.item["Tiempo sin atención"]),size:"sm"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Validar ")])),_:2},1032,["variant"])])),_:1},8,["items","fields","per-page","current-page","sort-by","sort-desc","filter","filter-included-fields","onFiltered"])])])),_:1})])),_:1})])),_:1})])])),_:1})}a(560);var p=a(4642),g=a(1022),b=a(381),O=a.n(b),_={components:{Layout:p.Z,PageHeader:g.Z},data(){return{title:"Gestión",TableInstalaciones:[],tableMantenimiento:[],tableDataGestor:[],tableDataOrder:[],GestorAgenda:[],Ciudades:[],ciudadId:"Lima",ciudadId2:"Lima",OrdenesGestor:[],GestorOrdenes:[],GestorAgendaId:null,OrdenesGestorId:null,GestorOrdenId:null,items:[{text:"Gestión",href:"/"},{text:"Listado",active:!0}],dataDateInstalaciones:null,currentPage:1,perPage:20,pageOptions:[10,25,50,100],filter:null,filterOn:[],sortBy:"age",sortDesc:!1,fields:[],dataDateMantenimientos:null,currentPage2:1,perPage2:20,pageOptions2:[10,25,50,100],filter2:null,filterOn2:[],sortBy2:"age",sortDesc2:!1,fieldsMantenimiento:[],dataDateGestor:null,currentPageGestor:1,perPageGestor:20,pageOptionsGestor:[10,25,50,100],filterOnGestor:[],filterGestor:null,sortByGestor:"age",sortDescGestor:!1,fieldsGestor:[],dataDateOrder:null,currentPageOrder:1,perPageOrder:20,pageOptionsOrder:[10,25,50,100],filterOnOrder:[],filterOrder:null,sortByOrder:"age",sortDescOrder:!1,fieldsOrder:[],totalesOrder:0,previousTableMantenimientosData:{},previousTableInstalacionesData:{},previousTableGestorData:{},previousTableOrderData:{}}},mounted(){this.getCity(),this.getGestorAgenda(),this.getOrdenesGestor()},methods:{formatearHora(e){const t=O()(e,["DD/MM/YYYY HH:mm:ss","YYYY-MM-DDTHH:mm:ss"]);return t.isValid()?t.format("HH:mm:ss"):": "+e},async fetchData(e,t=4e3){try{const a=this.$http.get(this.$apiURL+e),s=new Promise(((e,a)=>setTimeout((()=>a(new Error("Timeout"))),t))),r=await Promise.race([a,s]);return r.data}catch(a){return null}},async getGestorAgenda(){try{const e=await this.fetchData("manager/managersaltas");e&&e.data?(e.data.map((e=>this.GestorAgenda.push(e.manager))),this.GestorAgendaId=this.GestorAgenda[0]):this.GestorAgendaId="",this.getTableGestor()}catch(e){console.error(e)}},async getCity(){try{const e=await this.fetchData("city/all");e&&e.data?(e.data.forEach((e=>this.Ciudades.push(e.name))),this.ciudadId=this.Ciudades[0],this.ciudadId2=this.Ciudades[0]):(this.ciudadId="Lima",this.ciudadId2="Lima"),this.getTableInstalaciones(),this.getTableMantenimientos()}catch(e){console.error(e)}},async getOrdenesGestor(){try{const e=await this.fetchData("manager/managersaverias");e&&e.data?(e.data.forEach((e=>this.OrdenesGestor.push(e.manager))),this.OrdenesGestorId=this.OrdenesGestor[0]):this.OrdenesGestorId="",this.getTableOrder()}catch(e){console.error(e)}},async getTableMantenimientos(){try{null!=this.ciudadId2&&this.$nextTick((async()=>{this.tableMantenimiento.splice(0,this.tableMantenimiento.length),this.fieldsMantenimiento.splice(0,this.fieldsMantenimiento.length);const e=4e3,t=this.$http.get(this.$apiURL+"management/maintenanceprogresstable/"+this.ciudadId2),a=new Promise((t=>setTimeout(t,e))),s=await Promise.race([t,a]);if(s&&null!==s&&"series"in s.data&&s.data.series.length>0)s.data.series.map((e=>this.tableMantenimiento.push({...e}))),s.data.fields.map((e=>this.fieldsMantenimiento.push({key:e,sortable:!0}))),this.dataDateMantenimientos=this.formatearHora(s.data.date),localStorage.setItem("maintenance_progress_table",JSON.stringify(s));else{const e=JSON.parse(localStorage.getItem("maintenance_progress_table"));console.log(e),e&&(e.data.series.map((e=>this.tableMantenimiento.push({...e}))),e.data.fields.map((e=>this.fieldsMantenimiento.push({key:e,sortable:!0}))),this.dataDateMantenimientos=this.formatearHora(e.data.date))}}))}catch(e){console.error(e)}},async getTableInstalaciones(){try{null!=this.ciudadId&&this.$nextTick((async()=>{this.TableInstalaciones.splice(0,this.TableInstalaciones.length),this.fields.splice(0,this.fields.length);const e=4e3,t=this.$http.get(this.$apiURL+"management/installationprogresstable/"+this.ciudadId),a=new Promise((t=>setTimeout(t,e))),s=await Promise.race([t,a]);if(console.log(s),s&&null!==s&&"series"in s.data&&s.data.series.length>0)s.data.series.map((e=>this.TableInstalaciones.push({...e}))),s.data.fields.map((e=>this.fields.push({key:e,sortable:!0}))),this.dataDateInstalaciones=this.formatearHora(s.data.date),localStorage.setItem("installation_progress_table",JSON.stringify(s));else{const e=JSON.parse(localStorage.getItem("installation_progress_table"));e&&(e.data.series.map((e=>this.TableInstalaciones.push({...e}))),e.data.fields.map((e=>this.fields.push({key:e,sortable:!0}))),this.dataDateInstalaciones=this.formatearHora(e.data.date))}}))}catch(e){console.error(e)}},async getTableGestor(){try{null!=this.GestorAgendaId&&this.$nextTick((async()=>{this.tableDataGestor.splice(0,this.tableDataGestor.length),this.fieldsGestor.splice(0,this.fieldsGestor.length);const e=4e3,t=this.$http.get(this.$apiURL+"management/installationlogmanagertable/"+this.GestorAgendaId),a=new Promise((t=>setTimeout(t,e))),s=await Promise.race([t,a]);if(s&&null!==s&&"series"in s.data&&s.data.series.length>0)s.data.series.map((e=>this.tableDataGestor.push({...e}))),s.data.categories.map((e=>this.fieldsGestor.push({key:e,sortable:!0}))),this.dataDateGestor=this.formatearHora(s.data.date),localStorage.setItem("installation_manager_table",JSON.stringify(s));else{const e=JSON.parse(localStorage.getItem("installation_manager_table"));e&&(e.data.series.map((e=>this.tableDataGestor.push({...e}))),e.data.categories.map((e=>this.fieldsGestor.push({key:e,sortable:!0}))),this.dataDateGestor=this.formatearHora(e.data.date))}}))}catch(e){console.error(e)}},async getTableOrder(){try{null!=this.OrdenesGestorId&&this.$nextTick((async()=>{this.tableDataOrder.splice(0,this.tableDataOrder.length),this.fieldsOrder.splice(0,this.fieldsOrder.length);const e=4e3,t=this.$http.get(this.$apiURL+"management/ordermanagertable/"+this.OrdenesGestorId),a=new Promise((t=>setTimeout(t,e))),s=await Promise.race([t,a]);if(s&&null!==s&&"series"in s.data&&s.data.series.length>0)s.data.series.map((e=>this.tableDataOrder.push({...e}))),s.data.categories.map((e=>this.fieldsOrder.push({key:e,sortable:!0}))),this.dataDateOrder=this.formatearHora(s.data.date),localStorage.setItem("order_manager_table",JSON.stringify(s));else{const e=JSON.parse(localStorage.getItem("order_manager_table"));e&&(e.data.series.map((e=>this.tableDataOrder.push({...e}))),e.data.categories.map((e=>this.fieldsOrder.push({key:e,sortable:!0}))),this.dataDateOrder=this.formatearHora(e.data.date))}}))}catch(e){console.error(e)}},getColor(e){return console.log(e),"success"}},middleware:"authentication"},w=a(3744);const G=(0,w.Z)(_,[["render",h]]);var y=G}}]);
//# sourceMappingURL=480.1bf46c2c.js.map