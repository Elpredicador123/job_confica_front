"use strict";(self["webpackChunkminible"]=self["webpackChunkminible"]||[]).push([[579],{3318:function(e,t,s){s.r(t),s.d(t,{default:function(){return T}});var l=s(6252);const r={id:"tickets-table_length",class:"dataTables_length"},a={class:"d-inline-flex align-items-center"},o={class:"col-sm-12 col-md-6"},i={id:"tickets-table_filter",class:"dataTables_filter text-md-end"},n={class:"d-inline-flex align-items-center"},u={class:"table-responsive mb-0"},d={class:"dataTables_paginate paging_simple_numbers float-end"},m={class:"pagination pagination-rounded mb-0"};function c(e,t,s,c,p,f){const h=(0,l.up)("PageHeader"),g=(0,l.up)("BCardTitle"),w=(0,l.up)("BFormSelect"),U=(0,l.up)("BCol"),_=(0,l.up)("BFormInput"),b=(0,l.up)("BRow"),v=(0,l.up)("BButton"),W=(0,l.up)("BTable"),y=(0,l.up)("BPagination"),k=(0,l.up)("BCardBody"),$=(0,l.up)("BCard"),B=(0,l.up)("UserModal"),C=(0,l.up)("Layout");return(0,l.wg)(),(0,l.j4)(C,null,{default:(0,l.w5)((()=>[(0,l.Wm)(h,{title:e.title,items:e.items},null,8,["title","items"]),(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(U,{cols:"12"},{default:(0,l.w5)((()=>[(0,l.Wm)($,{"no-body":""},{default:(0,l.w5)((()=>[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Listado de Usuarios")])),_:1}),(0,l.Wm)(b,{class:"mt-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{sm:"12",md:"6"},{default:(0,l.w5)((()=>[(0,l._)("div",r,[(0,l._)("label",a,[(0,l.Uk)(" Show  "),(0,l.Wm)(w,{modelValue:p.perPageUser,"onUpdate:modelValue":t[0]||(t[0]=e=>p.perPageUser=e),size:"sm",options:p.pageOptionsUser},null,8,["modelValue","options"]),(0,l.Uk)(" entries ")])])])),_:1}),(0,l._)("div",o,[(0,l._)("div",i,[(0,l._)("label",n,[(0,l.Uk)(" Search: "),(0,l.Wm)(_,{modelValue:p.filterUser,"onUpdate:modelValue":t[1]||(t[1]=e=>p.filterUser=e),type:"search",placeholder:"Search...",class:"form-control form-control-sm ms-2"},null,8,["modelValue"])])])])])),_:1}),(0,l._)("div",u,[(0,l.Wm)(W,{items:p.tableDataUser,fields:p.fieldsUser,responsive:"sm","per-page":p.perPageUser,"current-page":p.currentPageUser,"sort-by":p.sortByUser,"sort-desc":p.sortDescUser,filter:p.filterUser,"filter-included-fields":p.filterOnUser,onFiltered:f.onFilteredUser},{"cell(actions)":(0,l.w5)((({item:e})=>[(0,l.Wm)(v,{onClick:t=>f.editItem(e),variant:"info"},{default:(0,l.w5)((()=>[(0,l.Uk)("Editar")])),_:2},1032,["onClick"])])),_:1},8,["items","fields","per-page","current-page","sort-by","sort-desc","filter","filter-included-fields","onFiltered"])]),(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l._)("div",d,[(0,l._)("ul",m,[(0,l.Wm)(y,{modelValue:p.currentPageUser,"onUpdate:modelValue":t[2]||(t[2]=e=>p.currentPageUser=e),"total-rows":p.totalRowsUser,"per-page":p.perPageUser},null,8,["modelValue","total-rows","per-page"])])])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(B,{ref:"UserModal"},null,512)])),_:1})}s(560);var p=s(4642),f=s(1022),h=s(9963),g=s(3577);const w={class:"mt-4"},U={key:0,class:"invalid-feedback"},_={class:"mt-4"},b={key:0,class:"invalid-feedback"},v={class:"mt-4"},W={class:"mt-3 text-end"};function y(e,t,s,r,a,o){const i=(0,l.up)("BCardTitle"),n=(0,l.up)("BFormInput"),u=(0,l.up)("BFormGroup"),d=(0,l.up)("BCol"),m=(0,l.up)("Multiselect"),c=(0,l.up)("BRow"),p=(0,l.up)("BButton"),f=(0,l.up)("BCardBody"),y=(0,l.up)("BCard"),k=(0,l.up)("BModal");return(0,l.wg)(),(0,l.j4)(k,{modelValue:a.isOpen,"onUpdate:modelValue":t[4]||(t[4]=e=>a.isOpen=e),size:"xl","hide-footer":""},{default:(0,l.w5)((()=>[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{cols:"12"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{"no-body":""},{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Editar usuario")])),_:1}),(0,l._)("form",{autocomplete:"off",class:"row no-gutters",onSubmit:t[3]||(t[3]=(0,h.iM)(((...t)=>e.submit&&e.submit(...t)),["prevent"]))},[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{lg:"4"},{default:(0,l.w5)((()=>[(0,l._)("div",w,[(0,l.Wm)(u,{id:"email-group",label:"Usuario",class:"mb-3","label-for":"formrow-firstname-input"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{id:"formrow-firstname-input",modelValue:a.user.username,"onUpdate:modelValue":t[0]||(t[0]=e=>a.user.username=e),type:"text",autocomplete:"off",placeholder:"Ingresar usuario",class:(0,g.C_)({"is-invalid":a.submitted&&r.v$.user.username.$error})},null,8,["modelValue","class"]),a.submitted&&r.v$.user.username.required.$invalid?((0,l.wg)(),(0,l.iD)("div",U," Usuario es requerido. ")):(0,l.kq)("",!0)])),_:1})])])),_:1}),(0,l.Wm)(d,{lg:"4"},{default:(0,l.w5)((()=>[(0,l._)("div",_,[(0,l.Wm)(u,{id:"password-group",label:"Contraseña",class:"mb-3","label-for":"password"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{id:"password",modelValue:a.user.password,"onUpdate:modelValue":t[1]||(t[1]=e=>a.user.password=e),type:"password",placeholder:"Ingresar contraseña",class:(0,g.C_)({"is-invalid":a.submitted&&r.v$.user.password.$error})},null,8,["modelValue","class"]),a.submitted&&r.v$.user.password.required.$invalid?((0,l.wg)(),(0,l.iD)("div",b," Contraseña es requerida. ")):(0,l.kq)("",!0)])),_:1})])])),_:1}),(0,l.Wm)(d,{lg:"4"},{default:(0,l.w5)((()=>[(0,l._)("div",v,[(0,l.Wm)(u,{label:"Rol","label-for":"formrow-firstname-input",class:"mb-12"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:a.user.role_id,"onUpdate:modelValue":t[2]||(t[2]=e=>a.user.role_id=e),required:"",options:a.roles.map((e=>({value:e.id,label:e.description}))),class:"form-control p-0"},null,8,["modelValue","options"])])),_:1})])])),_:1})])),_:1}),(0,l._)("div",W,[(0,l.Wm)(p,{variant:"primary",class:"w-sm",onClick:o.tryToRegisterIn},{default:(0,l.w5)((()=>[(0,l.Uk)("Actualizar ")])),_:1},8,["onClick"])])],32)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}var k=s(5705),$=s(760),B=s(7091),C={components:{Multiselect:B.Z},setup(){return{v$:(0,k.Xw)()}},data(){return{isOpen:!1,user:{},roles:[],rol:null,submitted:!1,tryingToRegister:!1,isRegisterError:!1,title:"NUEVO USUARIO"}},validations:{user:{username:{required:$.C1},password:{required:$.C1},role_id:{required:$.C1}}},computed:{notification(){return this.$store?this.$store.state.notification:null},notificationAutoCloseDuration(){return this.$store&&this.$store.state.notification?5:0}},mounted(){this.initForm(),this.getRol()},methods:{initForm(){this.user={username:"null",password:null,role_id:null}},async getRol(){try{const e=await this.$http.get(this.$apiURL+"role/all"),t=e.data.data;t.forEach((e=>{this.roles.push(e)})),console.log(this.roles)}catch(e){console.error("Error fetching roles:",e)}},open(e){console.log(e),this.isOpen=!0;const{rol:t,...s}=e;this.rol=t,this.user={...s}},saveChanges(){this.$emit("edit-complete",this.selectedItem),this.close()},close(){this.isOpen=!1,this.selectedItem=null},tryToRegisterIn(){if(this.submitted=!0,this.v$.$touch(),!this.v$.$invalid){const{username:e,password:t}=this.user;e&&t&&this.$http.put(this.$apiURL+"user/update/"+this.user.id,this.user,{}).then((e=>{200==e.status&&(this.$swal({title:"Completado!",text:e.data.message,icon:"success",confirmButtonColor:"#6457A2"}),setTimeout((()=>{window.location.reload()}),2e3))})).catch((e=>{console.error(e),this.$swal({icon:"error",title:"Oops...",text:e})}))}}}},V=s(3744);const R=(0,V.Z)(C,[["render",y]]);var O=R,I={components:{Layout:p.Z,PageHeader:f.Z,UserModal:O},data(){return{itemsUser:[{text:"Charts",href:"/"},{text:"Apex",active:!0}],tableDataUser:[],totalRowsUser:1,currentPageUser:1,perPageUser:25,pageOptionsUser:[10,25,50,100],filterOnUser:[],filterUser:null,sortByUser:"age",sortDescUser:!1,fieldsUser:[{key:"id",sortable:!0},{key:"username",sortable:!0},{key:"rol",sortable:!0},{key:"actions",sortable:!0}]}},mounted(){this.totalRowsUser=this.itemsUser.length,this.getTableUser()},methods:{onFilteredUser(e){this.totalRowsUser=e.length,this.currentPageUser=1},async getTableUser(){console.log("hola");try{const e=await this.$http.get(this.$apiURL+"user/all");console.log(e),e.data.data.map((e=>this.tableDataUser.push({...e}))),this.totalRowsUser=this.tableDataUser.length}catch(e){console.error(e)}},editItem(e){console.log("Editar item",e),this.selectedItem=JSON.parse(JSON.stringify(e)),this.$refs.UserModal.open(this.selectedItem)}},middleware:"authentication"};const P=(0,V.Z)(I,[["render",c]]);var T=P}}]);
//# sourceMappingURL=579.b1e4e84f.js.map